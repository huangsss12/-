# 文本转语音及视频生成工具使用说明

## 简介

文本转语音及视频生成工具是一个基于Microsoft Edge TTS引擎的应用程序，可以将文本内容转换为自然流畅的语音，并可选择生成带有黑色背景的视频文件。该工具提供了丰富的中文语音选项和语速调整功能，适用于配音、学习材料制作、内容创作等多种场景。

## 功能特点

- **文本转语音**：将输入的文本转换为高质量的语音文件（MP3格式）
- **视频生成**：自动将语音与黑色背景合成为视频文件（MP4格式）
- **多种语音选项**：支持14种不同的中文语音，包括：
  - 普通话（男声/女声）
  - 方言（东北话、陕西话）
  - 粤语（香港）
  - 台湾国语
- **语速调整**：可在-100%到+100%范围内灵活调整语音速度
- **简洁界面**：直观的图形用户界面，操作简单

## 使用前提

本工具依赖以下Python库：
- edge-tts
- moviepy
- tkinter (通常Python自带)

如果您使用的是可执行文件版本，则无需安装这些依赖。

## 使用方法

### 基本操作流程

1. **输入文本**：在"输入文本"区域输入或粘贴需要转换的文本内容
2. **选择输出路径**：点击"浏览..."按钮，选择文件保存的目标文件夹
3. **选择语音**：从下拉菜单中选择合适的语音类型
4. **调整语速**：使用滑动条调整语音的播放速度（可选）
5. **开始生成**：点击"开始生成"按钮，等待处理完成
6. **查看结果**：处理完成后，系统会显示成功消息，您可以在指定的输出路径找到生成的文件

### 参数说明

#### 语音选项

工具提供以下语音选项：

| 语音代码 | 描述 | 特点 |
|---------|------|------|
| zh-CN-YunjianNeural | 男声 (Yunjian) | 适合体育/小说，富有激情 |
| zh-CN-YunxiNeural | 男声 (Yunxi) | 适合小说，活泼阳光 |
| zh-CN-YunxiaNeural | 男声 (Yunxia) | 适合动漫/小说，可爱 |
| zh-CN-YunyangNeural | 男声 (Yunyang) | 适合新闻，专业可靠 |
| zh-CN-XiaoxiaoNeural | 女声 (Xiaoxiao) | 适合新闻/小说，温暖 |
| zh-CN-XiaoyiNeural | 女声 (Xiaoyi) | 适合动漫/小说，活泼 |
| zh-CN-liaoning-XiaobeiNeural | 女声 (Xiaobei) | 东北方言，幽默 |
| zh-CN-shaanxi-XiaoniNeural | 女声 (Xiaoni) | 陕西方言，明亮 |
| zh-HK-HiuGaaiNeural | 女声 (HiuGaai) | 粤语，友好积极 |
| zh-HK-HiuMaanNeural | 女声 (HiuMaan) | 粤语，友好积极 |
| zh-HK-WanLungNeural | 男声 (WanLung) | 粤语，友好积极 |
| zh-TW-HsiaoChenNeural | 女声 (HsiaoChen) | 台湾国语，友好积极 |
| zh-TW-HsiaoYuNeural | 女声 (HsiaoYu) | 台湾国语，友好积极 |
| zh-TW-YunJheNeural | 男声 (YunJhe) | 台湾国语，友好积极 |

#### 语速调整

语速调整范围为-100%到+100%：
- 负值：语速变慢，数值越小越慢
- 0%：正常语速
- 正值：语速变快，数值越大越快

## 输出文件

程序会在指定的输出路径生成两个文件：
1. **MP3文件**：纯语音文件
2. **MP4文件**：带有黑色背景的视频文件

文件命名格式为：`日期_文本前6个字符.扩展名`  
例如：`20230615_你好世界.mp3` 和 `20230615_你好世界.mp4`

## 视频规格

生成的视频具有以下规格：
- 分辨率：1280 x 720 (720p)
- 背景颜色：纯黑色
- 视频编码：H.264 (libx264)
- 音频编码：AAC
- 帧率：24fps
- 时长：与语音文件相同

## 常见问题

### Q: 程序运行时出现错误怎么办？
A: 程序会自动记录错误信息到`error_log.txt`文件中。如果遇到问题，请查看该日志文件以获取详细信息。

### Q: 为什么生成的语音有时会出现不自然的停顿？
A: 这可能与文本中的标点符号有关。尝试调整文本中的标点符号，或者在需要停顿的地方添加适当的逗号或句号。

### Q: 能否调整生成视频的分辨率或背景颜色？
A: 当前版本不支持在界面上直接修改这些参数。如果有特殊需求，可能需要修改源代码。

### Q: 处理长文本时程序会变慢吗？
A: 是的，处理长文本可能需要更多时间。建议将长文本分成多个部分分别处理，然后使用视频编辑软件合并。

## 注意事项

1. 确保输出路径有足够的磁盘空间
2. 处理过程中请勿关闭程序窗口
3. 生成的文件会自动覆盖同名文件，请注意备份重要内容
4. 该工具使用Microsoft Edge TTS服务，需要网络连接才能正常工作

## 技术支持

如遇到问题，请查看错误日志文件`error_log.txt`，或联系技术支持人员。
